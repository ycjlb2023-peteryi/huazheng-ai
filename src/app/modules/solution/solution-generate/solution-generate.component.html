<div class="solution-generate">
  <app-page-header 
    title="AIæŠ€æœ¯æ–¹æ¡ˆç”Ÿæˆ" 
    subtitle="è¾“å…¥å®¢æˆ·éœ€æ±‚ï¼Œ3åˆ†é’Ÿç”Ÿæˆä¸“ä¸šæŠ€æœ¯æ–¹æ¡ˆ"
  >
    <div actions>
      @if (showResult()) {
        <button class="btn btn-secondary" (click)="resetForm()">
          é‡æ–°ç”Ÿæˆ
        </button>
      }
    </div>
  </app-page-header>
  
  <div class="generate-content">
    @if (!showResult()) {
      <!-- è¾“å…¥é˜¶æ®µ -->
      <div class="input-section">
        <div class="input-panel card">
          <h3 class="panel-title">å®¢æˆ·éœ€æ±‚è¾“å…¥</h3>
          
          <div class="form-group">
            <label class="form-label">å®¢æˆ·æè¿°ï¼ˆæ”¯æŒä¸­è‹±æ–‡ï¼‰</label>
            <textarea
              class="textarea"
              rows="8"
              placeholder="ä¾‹å¦‚ï¼šå®¢æˆ·éœ€è¦ä¸€å°ç”¨äºå˜å‹å™¨æ²¹å¤„ç†çš„æ»¤æ²¹æœºï¼Œæ—¥å¤„ç†é‡çº¦10å¨ï¼Œéœ€è¦è¾¾åˆ°GB/T 7595æ ‡å‡†..."
              [value]="customerRequirement()"
              (input)="updateRequirement($any($event.target).value)"
              [disabled]="isGenerating()"
            ></textarea>
          </div>
          
          <div class="form-group">
            <label class="form-label">è¾“å‡ºè¯­è¨€</label>
            <div class="radio-group">
              <label class="radio-label">
                <input
                  type="radio"
                  name="language"
                  value="en"
                  [checked]="selectedLanguage() === 'en'"
                  (change)="updateLanguage('en')"
                  [disabled]="isGenerating()"
                />
                <span>è‹±æ–‡ï¼ˆæ¨èï¼‰</span>
              </label>
              <label class="radio-label">
                <input
                  type="radio"
                  name="language"
                  value="zh"
                  [checked]="selectedLanguage() === 'zh'"
                  (change)="updateLanguage('zh')"
                  [disabled]="isGenerating()"
                />
                <span>ä¸­æ–‡</span>
              </label>
            </div>
          </div>
          
          <div class="action-buttons">
            <button
              class="btn btn-primary btn-lg"
              (click)="generateSolution()"
              [disabled]="!customerRequirement().trim() || isGenerating()"
            >
              @if (isGenerating()) {
                <span class="spinner"></span>
                <span>AIç”Ÿæˆä¸­...</span>
              } @else {
                <span>âš¡</span>
                <span>ç”ŸæˆæŠ€æœ¯æ–¹æ¡ˆ</span>
              }
            </button>
          </div>
        </div>
        
        <div class="suggestions-panel card">
          <h3 class="panel-title">ğŸ’¡ AIæç¤ºé—®é¢˜</h3>
          <p class="panel-description">ç‚¹å‡»ä¸‹æ–¹é—®é¢˜å¯å¿«é€Ÿæ·»åŠ åˆ°è¾“å…¥æ¡†</p>
          
          <div class="suggestions-list">
            @for (question of suggestedQuestions(); track question) {
              <button
                class="suggestion-item"
                (click)="addSuggestedQuestion(question)"
                [disabled]="isGenerating()"
              >
                <span class="suggestion-icon">â“</span>
                <span class="suggestion-text">{{ question }}</span>
              </button>
            }
          </div>
          
          <div class="tips-box">
            <div class="tips-icon">ğŸ’¡</div>
            <div class="tips-content">
              <p class="tips-title">ä½¿ç”¨æŠ€å·§</p>
              <ul class="tips-list">
                <li>æè¿°è¶Šè¯¦ç»†ï¼Œæ–¹æ¡ˆè¶Šç²¾å‡†</li>
                <li>å¯ä»¥åŒ…å«æŠ€æœ¯å‚æ•°å’Œæ ‡å‡†è¦æ±‚</li>
                <li>æ”¯æŒä¸­è‹±æ–‡æ··åˆè¾“å…¥</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    } @else {
      <!-- ç»“æœå±•ç¤ºé˜¶æ®µ -->
      <div class="result-section">
        <div class="result-layout">
          <!-- å·¦ä¾§ï¼šæŠ€æœ¯æ–¹æ¡ˆï¼ˆå†…éƒ¨ï¼‰ -->
          <div class="result-panel card">
            <div class="panel-header">
              <h3 class="panel-title">ğŸ”§ æŠ€æœ¯æ–¹æ¡ˆï¼ˆå†…éƒ¨ç‰ˆï¼‰</h3>
              <span class="badge badge-success">å·²ç”Ÿæˆ</span>
            </div>
            
            @if (currentSolution(); as solution) {
              <div class="solution-sections">
                <div class="solution-section">
                  <h4 class="section-title">äº§å“åˆ¤æ–­</h4>
                  <p class="section-content">{{ solution.productJudgment }}</p>
                </div>
                
                <div class="solution-section">
                  <h4 class="section-title">æ¨èé…ç½®</h4>
                  
                  <div class="config-group">
                    <h5 class="config-title">âœ… æ ‡é…é¡¹ç›®</h5>
                    <ul class="config-list">
                      @for (item of solution.recommendedConfig.standard; track item) {
                        <li class="config-item">{{ item }}</li>
                      }
                    </ul>
                  </div>
                  
                  <div class="config-group">
                    <h5 class="config-title">ğŸ”¸ é€‰é…é¡¹ç›®</h5>
                    <ul class="config-list optional">
                      @for (item of solution.recommendedConfig.optional; track item) {
                        <li class="config-item">{{ item }}</li>
                      }
                    </ul>
                  </div>
                </div>
                
                <div class="solution-section">
                  <h4 class="section-title">æŠ€æœ¯ä¾æ®</h4>
                  <ul class="basis-list">
                    @for (basis of solution.technicalBasis; track basis) {
                      <li class="basis-item">
                        <span class="basis-icon">ğŸ“„</span>
                        <span>{{ basis }}</span>
                      </li>
                    }
                  </ul>
                </div>
                
                <div class="solution-section warning">
                  <h4 class="section-title">âš ï¸ å¾…å®¢æˆ·ç¡®è®¤é—®é¢˜</h4>
                  <ul class="questions-list">
                    @for (question of solution.questionsForCustomer; track question) {
                      <li class="question-item">{{ question }}</li>
                    }
                  </ul>
                </div>
              </div>
            }
          </div>
          
          <!-- å³ä¾§ï¼šå®¢æˆ·å›å¤ -->
          <div class="reply-panel card">
            <div class="panel-header">
              <h3 class="panel-title">âœ‰ï¸ å®¢æˆ·å›å¤å†…å®¹</h3>
              <div class="export-actions">
                @for (option of exportOptions; track option.label) {
                  <button
                    class="btn btn-sm btn-secondary"
                    (click)="option.action()"
                    [title]="option.label"
                  >
                    <span>{{ option.icon }}</span>
                  </button>
                }
              </div>
            </div>
            
            @if (currentSolution(); as solution) {
              <div class="reply-content">
                <pre class="reply-text">{{ solution.customerReply }}</pre>
              </div>
              
              <div class="reply-footer">
                <p class="footer-note">
                  âœ… æ­¤å†…å®¹å¯ç›´æ¥å¤åˆ¶å‘é€ç»™å®¢æˆ·
                </p>
              </div>
            }
          </div>
        </div>
      </div>
    }
  </div>
  
  @if (isGenerating()) {
    <app-loading-spinner
      [fullscreen]="true"
      text="AIæ­£åœ¨åˆ†æéœ€æ±‚å¹¶ç”ŸæˆæŠ€æœ¯æ–¹æ¡ˆ..."
      [size]="60"
    />
  }
</div>

